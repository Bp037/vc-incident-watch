<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>VC Incident Watch</title>
<style>
body { margin:0; font-family:system-ui; background:#000; color:#fff; }
header { background:#8c1111; padding:12px; }
button { padding:8px 12px; border-radius:999px; border:none; background:#222; color:#fff; cursor:pointer; }
button.active { background:#444; }
#rows { padding:16px; }
.row { border-bottom:1px solid #333; padding:12px 0; }
</style>
</head>

<body>
<header>
  <h2>VC Incident Watch</h2>
  <button id="vcBtn" class="active">Ventura County</button>
  <button id="chpBtn">CHP</button>
  <span id="status">Idle</span>
</header>

<div id="rows">Loading…</div>

<script>
const VC_API = "https://firefeeds.venturacounty.gov/api/incidents";
const CHP_API = "https://bp037.brallanp.workers.dev/chp?lat1=33.9&lat2=34.9&lon1=-119.9&lon2=-118.6";

let current = "vc";

const rows = document.getElementById("rows");
const status = document.getElementById("status");
const vcBtn = document.getElementById("vcBtn");
const chpBtn = document.getElementById("chpBtn");

vcBtn.onclick = () => { current="vc"; vcBtn.classList.add("active"); chpBtn.classList.remove("active"); load(); };
chpBtn.onclick = () => { current="chp"; chpBtn.classList.add("active"); vcBtn.classList.remove("active"); load(); };

async function load() {
  status.textContent = "Loading…";
  rows.textContent = "Loading…";
  try {
    const url = current === "vc" ? VC_API : CHP_API;
    const res = await fetch(url);
    const data = await res.json();

    rows.innerHTML = "";
    data.forEach(x => {
      const div = document.createElement("div");
      div.className = "row";
      div.textContent = JSON.stringify(x, null, 2);
      rows.appendChild(div);
    });

    status.textContent = "Updated";
  } catch (e) {
    rows.textContent = "Failed to load";
    status.textContent = "Error";
    console.error(e);
  }
}

load();
</script>
</body>
</html>

